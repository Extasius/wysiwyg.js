!function(e,t,n){"use strict";var r=function(e,t,n){var r;return function(){if(r){if(!n)return;clearTimeout(r)}var o=this,i=arguments;r=setTimeout(function(){r=null,e.apply(o,i)},t)}},o=function(e,t,n,r){e.addEventListener(t,n,!!r)},i=function(e,t,n,r){e.removeEventListener(t,n,!!r)},a=function(e){e.preventDefault(),e.stopPropagation()},l=function(e,t,n){for(var r=n?t.parentNode:t;r;){if(r===e)return!0;r=r.parentNode}return!1},c=function(e){var t=e.nodeName;return"IMG"==t||"PICTURE"==t||"SVG"==t||"VIDEO"==t||"AUDIO"==t||"IFRAME"==t||"MAP"==t||"OBJECT"==t||"EMBED"==t},s=function(t){var n=e.getSelection();return n.rangeCount>0?n.getRangeAt(0):null},u=function(t,n){if(n){var r=e.getSelection();r.removeAllRanges(),r.addRange(n)}},f=function(){var t=e.getSelection();if(!t.rangeCount)return!1;var n=t.getRangeAt(0).cloneRange(),r=n.getBoundingClientRect();if(r&&r.left&&r.top&&r.right&&r.bottom)return{left:parseInt(r.left),top:parseInt(r.top),width:parseInt(r.right-r.left),height:parseInt(r.bottom-r.top)};for(var o=n.getClientRects?n.getClientRects():[],i=0;i<o.length;++i){var r=o[i];if(r.left&&r.top&&r.right&&r.bottom)return{left:parseInt(r.left),top:parseInt(r.top),width:parseInt(r.right-r.left),height:parseInt(r.bottom-r.top)}}return!1},h=function(t){return!!e.getSelection().isCollapsed},p=function(n){var r=e.getSelection();if(!r.rangeCount)return[];for(var o=[],i=0;i<r.rangeCount;++i)for(var a=r.getRangeAt(i),c=a.startContainer,s=a.endContainer;c;){if(c!=n){var u=!1;if(r.containsNode)u=r.containsNode(c,!0);else{var f=t.createRange();f.selectNodeContents(c);for(var i=0;i<r.rangeCount;++i){var a=r.getRangeAt(i);if(a.compareBoundaryPoints(a.END_TO_START,f)>=0&&a.compareBoundaryPoints(a.START_TO_END,f)<=0){u=!0;break}}}u&&o.push(c)}c=function(e,t){if(e.firstChild)return e.firstChild;for(;e;){if(e==t)return null;if(e.nextSibling)return e.nextSibling;e=e.parentNode}return null}(c,c==s?s:n)}return 0==o.length&&l(n,r.focusNode)&&r.focusNode!=n&&o.push(r.focusNode),o},d=function(){var t=e.getSelection();if(!t.isCollapsed)try{t.collapseToEnd()}catch(e){}},v=function(t,n,r){var o=e.getSelection();if(o.modify){for(var i=0;i<n;++i)o.modify("extend","backward","character");for(var i=0;i<r;++i)o.modify("extend","forward","character")}else{var a=o.getRangeAt(0);a.setStart(a.startContainer,a.startOffset-n),a.setEnd(a.endContainer,a.endOffset+r),o.removeAllRanges(),o.addRange(a)}},g=function(n){if(h())return null;var r=e.getSelection();if(r.rangeCount){for(var o=t.createElement("div"),i=r.rangeCount,a=0;a<i;++a){var l=r.getRangeAt(a).cloneContents();o.appendChild(l)}return o.innerHTML}return null},m=function(n,r){var o=e.getSelection();if(l(n,o.anchorNode)&&l(n,o.focusNode))return!0;if(!r)return!1;var i=t.createRange();return i.selectNodeContents(n),i.collapse(!1),o.removeAllRanges(),o.addRange(i),!0},w=function(n,r){var o=e.getSelection();if(o.getRangeAt&&o.rangeCount){var i=o.getRangeAt(0),a=t.createElement("div");a.innerHTML=r;for(var c,s,u=t.createDocumentFragment();c=a.firstChild;)s=u.appendChild(c);l(n,i.commonAncestorContainer)?(i.deleteContents(),i.insertNode(u)):n.appendChild(u),s&&(i=i.cloneRange(),i.setStartAfter(s),i.collapse(!0),o.removeAllRanges(),o.addRange(i))}},C=function(n,C){var b,y=C.toolbar,E=C.buttons,k=C.selectionbuttons,M=C.suggester,L=C.interceptenter,H=!!C.hijackmenu,S="string"==typeof n?t.querySelector(n):n,T=S.querySelector("textarea"),x={},R="top"==y,z="bottom"==y,N=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},A=function(e,t){e.classList&&e.classList.remove(t)},I=S.querySelector("[contenteditable=true]");if(!I){I=t.createElement("div"),I.setAttribute("contentEditable","true");var B=T.placeholder;B&&I.setAttribute("placeholder",B),S.insertBefore(I,S.firstChild)}var P=null,D=function(){P&&clearTimeout(P),P=null,N(S,"focus")},V=function(){P||t.activeElement==I||(P=setTimeout(function(){P=null,A(S,"focus")},50))};o(I,"focus",D),o(I,"blur",V),T&&T.form&&o(T.form,"reset",V);var O,W=function(n,r){var i=t.createElement("input");i.placeholder="www.example.com",r&&(i.value=r.href),i.style.width="20em",i.style.maxWidth=parseInt(2*S.offsetWidth/3)+"px",i.autofocus=!0,r&&o(i,"input",function(e){var t=i.value.trim();t&&(r.href=t)}),o(i,"keypress",function(e){if(13==(e.which||e.keyCode)){var t=i.value.trim();if(r);else if(t){var n=t;if(/^[a-z0-9]+:\/\//.test(t)||(n="http://"+t),b.getSelectedHTML())b.insertLink(n);else{var o=function(e){return e.replace(/[&<>"]/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[e]||e})};b.insertHTML('<a href="'+o(n)+'">'+o(t)+"</a>")}}b.closePopup().collapseSelection(),I.focus()}}),n.appendChild(i),e.setTimeout(function(){i.focus(),D()},1)},F=function(e,n){var r=t.createElement("table");r.style.borderCollapse="collapse";for(var i=1;i<15;++i){for(var a=t.createElement("tr"),l=0;l<25;++l){var c;if(24==l){var s=Math.floor(255/13*(14-i)).toString(16),u=(s.length<2?"0":"")+s;c="#"+u+u+u}else{var f=l/24,h=i<=8?i/8:1,p=i>8?(16-i)/8:1;c=function(e,t,n){var r,o,i,a,l,c,s,u;switch(a=Math.floor(6*e),l=6*e-a,c=n*(1-t),s=n*(1-l*t),u=n*(1-(1-l)*t),a%6){case 0:r=n,o=u,i=c;break;case 1:r=s,o=n,i=c;break;case 2:r=c,o=n,i=u;break;case 3:r=c,o=s,i=n;break;case 4:r=u,o=c,i=n;break;case 5:r=n,o=c,i=s}var f=Math.floor(255*r).toString(16),h=Math.floor(255*o).toString(16),p=Math.floor(255*i).toString(16);return"#"+(f.length<2?"0":"")+f+(h.length<2?"0":"")+h+(p.length<2?"0":"")+p}(f,h,p)}var d=t.createElement("td");d.style.width="0.5em",d.style.height="0.5em",d.style.cursor="pointer",d.style.backgroundColor=c,d.title=c,d.style.userSelect="none",o(d,"click",function(e){var t=this.title;n?b.forecolor(t).closePopup().collapseSelection():b.highlight(t).closePopup().collapseSelection()}),a.appendChild(d)}r.appendChild(a)}e.appendChild(r)},_=function(n,r,o){for(var i=S.offsetParent,a=0,l=0,c=!1,s=0,u=0,f=!1,h=!1;i;){s+=i.offsetLeft,u+=i.offsetTop;var p=getComputedStyle(i);"static"!=p.position?c=!0:c||(a+=i.offsetLeft,l+=i.offsetTop),"fixed"==p.position&&(f=!0),"visible"!=p.overflow&&(h=!0),i=i.offsetParent}var d=S.offsetParent||t.body;d.appendChild(n),r+=a+S.offsetLeft,o+=l+S.offsetTop;var v=n.offsetWidth;if(f||h){var g=d.offsetWidth;r+v>g-1&&(r=g-v-1),r<1&&(r=1)}var m=n.offsetHeight;if(f||h){var w=d.offsetHeight;o+m>w-1&&(o=w-m-1),o<1&&(o=1)}var C=e.innerWidth,b=f?0:t.documentElement.scrollLeft;s+r+v>C+b-2&&(r=C+b-s-v-2),s+r<b+1&&(r=b-s+1);var y=e.innerHeight,E=f?0:t.documentElement.scrollTop;u+o+m>y+E-2&&(o=y+E-u-m-2),u+o<E+1&&(o=E-u+1),n.style.left=parseInt(r)+"px",n.style.top=parseInt(o)+"px"},q=function(){var e=b.openPopup();for(N(e,"wysiwyg-popup");e.firstChild;)e.removeChild(e.firstChild);return e},X=function(e,t,n){var r=q();t(r,n);var o=S.getBoundingClientRect(),i=e.getBoundingClientRect(),a=i.left-o.left+parseInt(e.offsetWidth/2)-parseInt(r.offsetWidth/2),l=i.top-o.top;R?l+=e.offsetHeight:l-=r.offsetHeight,_(r,a,l)},Y=function(e,t){var n=S.getBoundingClientRect(),r=I.getBoundingClientRect(),o=t.left+parseInt(t.width/2)-parseInt(e.offsetWidth/2)+r.left-n.left,i=t.top+t.height+r.top-n.top;_(e,o,i)},K=function(e,t,n){var r=q();t(r,n),Y(r,e)},U=null,G=null,j=function(e,n,r,i){r.forEach(function(r){if(r instanceof Element||r instanceof HTMLDocument)return e.appendChild(r),o(r,"focus",D),void o(r,"blur",V);var l=t.createElement("button");if(N(l,"btn"),"icon"in r){var c=null;switch(r.icon){case"link":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg>';break;case"bold":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"/></svg>';break;case"italic":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z"/></svg>';break;case"underline":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"/></svg>';break;case"strikethrough":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M7.24 8.75c-.26-.48-.39-1.03-.39-1.67 0-.61.13-1.16.4-1.67.26-.5.63-.93 1.11-1.29.48-.35 1.05-.63 1.7-.83.66-.19 1.39-.29 2.18-.29.81 0 1.54.11 2.21.34.66.22 1.23.54 1.69.94.47.4.83.88 1.08 1.43s.38 1.15.38 1.81h-3.01c0-.31-.05-.59-.15-.85-.09-.27-.24-.49-.44-.68-.2-.19-.45-.33-.75-.44-.3-.1-.66-.16-1.06-.16-.39 0-.74.04-1.03.13s-.53.21-.72.36c-.19.16-.34.34-.44.55-.1.21-.15.43-.15.66 0 .48.25.88.74 1.21.38.25.77.48 1.41.7H7.39c-.05-.08-.11-.17-.15-.25zM21 12v-2H3v2h9.62c.18.07.4.14.55.2.37.17.66.34.87.51s.35.36.43.57c.07.2.11.43.11.69 0 .23-.05.45-.14.66-.09.2-.23.38-.42.53-.19.15-.42.26-.71.35-.29.08-.63.13-1.01.13-.43 0-.83-.04-1.18-.13s-.66-.23-.91-.42c-.25-.19-.45-.44-.59-.75s-.25-.76-.25-1.21H6.4c0 .55.08 1.13.24 1.58s.37.85.65 1.21c.28.35.6.66.98.92.37.26.78.48 1.22.65.44.17.9.3 1.38.39.48.08.96.13 1.44.13.8 0 1.53-.09 2.18-.28s1.21-.45 1.67-.79c.46-.34.82-.77 1.07-1.27s.38-1.07.38-1.71c0-.6-.1-1.14-.31-1.61-.05-.11-.11-.23-.17-.33H21V12z"/></svg>';break;case"colortext":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path fill-opacity=".36" d="M0 20h24v4H0v-4z"/><path d="M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z"/></svg>';break;case"colorfill":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z"/><path fill-opacity=".36" d="M0 20h24v4H0v-4z"/></svg>';break;case"clearformat":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 8V5H6.39l3 3h1.83l-.55 1.28 2.09 2.1L14.21 8zM3.41 4.86L2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21l1.41-1.41z"/></svg>';break;case"photo":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z"/></svg>';break;case"attachment":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/></svg>';break;case"emoticon":c='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg>'}if(c){var s=t.implementation.createHTMLDocument("");s.body.innerHTML=c,l.appendChild(s.body.firstChild)}}if(r.attr)for(var u in r.attr)l.setAttribute(u,r.attr[u]);o(l,"focus",D),o(l,"blur",V);var f=null;"click"in r?f=function(){r.click(b,l)}:"popup"in r?f=function(){var e=function(e){r.popup(b,e,l)};n?K(n,e):X(l,e)}:"browse"in r||"dataurl"in r?f=function(){b.closePopup().collapseSelection();var e=t.createElement("input");e.type="file",e.multiple=!0,e.style.display="none",o(e,"change",function(t){var o="dataurl"in r;if(t.target.files)for(var i=n.target.files,c=0;c<i.length;++c){var s=i[c];if("browse"in r)r.browse(b,e,s,l);else if(s.size<16777216){var u=new FileReader;u.onloadend=function(e){r.dataurl(b,s.type,e.target.result,l)},u.readAsDataURL(s)}}else o=!0;o&&e.parentNode.removeChild(e),a(t)}),S.appendChild(e);var n=t.createEvent("MouseEvents");n.initEvent("click",!0,!1),e.dispatchEvent(n)}:"action"in r&&(f=function(){switch(r.action){case"link":n?K(n,W,G):X(l,W,G);break;case"bold":b.bold();break;case"italic":b.italic();break;case"underline":b.underline();break;case"strikethrough":b.strikethrough();break;case"colortext":n?K(n,F,!0):X(l,F,!0);break;case"colorfill":n?K(n,F,!1):X(l,F,!1);break;case"clearformat":b.removeFormat().closePopup().collapseSelection()}}),l.onclick=function(e){f&&f(),a(e)},e.appendChild(l),"hotkey"in r&&f&&i&&(i[r.hotkey.toLowerCase()]=f)})},J=null,$=1,Q=null,Z=function(e){e&&b.expandSelection(J.length,0).insertHTML(e),J=null,Q=null,$+=1,b.closePopup()},ee=function(e,t,n,r,o,i){return 13!=e||!Q||(Z(Q),!1)},te=function(){if(J){var e=$;M(J,function(n){if(U&&e==$){if(Q=null,!n)return void Z();K(U,function(e){n.forEach(function(n){var r=t.createElement("div");N(r,"suggestion"),r.innerHTML=n.label,r.style.cursor="pointer",o(r,"click",function(e){Z(n.insert),a(e)}),e.appendChild(r),null===Q&&(Q=n.insert)})})}})||Z()}},ne=r(te,100,!0),re=function(e,t,n,r,o,i){switch(e){case 8:if(J&&(J=J.slice(0,-1)),J)break;case 13:case 27:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:return Z(),!0;default:J||(J=""),J+=t}return ne(),!0},oe=function(e,t,n,r,o,i){if(L&&13==e&&!n&&!r&&!o&&!i&&(b.sync().closePopup(),L()))return!1;if(t&&!n&&!r&&o&&!i){var a=t.toLowerCase();if(!x[a])return;return x[a](),!1}return M?ee(e):void 0},ie=function(e,t,n,r,o,i){if(M)return re(e,t)},ae=function(e,n,r,o){if(U=e?n||U:null,G=null,!n)return void Z();if(e){if(null!==J){var i=b.activePopup();return void(i&&Y(i,n))}}else Z();for(var a=0;a<r.length;++a){var l=r[a],s=l.closest||function(e){for(var t=this;t;){var n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;if(n&&n.call(t,e))return t;t=t.parentElement}return null};if(G=s.call(l,"a"))break}var u=!0;if(o||(k?e?u=!1:r.forEach(function(e){c(e)&&(u=!1)}):u=!1),!u)return void Z();K(n,function(e){var r=t.createElement("div");N(r,"toolbar"),e.appendChild(r),j(r,n,k)})},le=function(){D()},ce=function(){Z(),V()},se=null,ue=null;if(T){!I.innerHTML&&T.value&&(I.innerHTML=T.value);var fe=I.innerHTML;se=function(){var e=I.innerHTML;e.match(/^<br[\/ ]*>$/i)&&(I.innerHTML="",e=""),e!=fe&&(T.value=e,fe=e)},o(I,"focus",function(){var e=t.createEvent("Event");e.initEvent("focus",!1,!1),T.dispatchEvent(e)}),o(I,"blur",function(){se();var e=t.createEvent("Event");e.initEvent("blur",!1,!1),T.dispatchEvent(e)}),ue=r(se,250,!0),o(I,"input",ue),o(I,"propertychange",ue),o(I,"textInput",ue),o(I,"paste",ue),o(I,"cut",ue),o(I,"drop",ue);new MutationObserver(ue).observe(I,{attributes:!0,childList:!0,characterData:!0,subtree:!0});var he=T.form;he&&o(he,"reset",function(){I.innerHTML="",ue(),O(!0)})}var pe=null,de=null;if(ae){de=r(function(e,t,n){var r=h(),o=p(I),i=null===e||null===t?null:{left:e,top:t,width:0,height:0},a=f();if(a&&(i=a),i){var l=I.getBoundingClientRect();i.left-=parseInt(l.left),i.top-=parseInt(l.top),i.left<0&&(i.left=0),i.top<0&&(i.top=0),i.width>I.offsetWidth&&(i.width=I.offsetWidth),i.height>I.offsetHeight&&(i.height=I.offsetHeight)}else if(o.length)for(var c=0;c<o.length;++c){var s=o[c];if(s.nodeType==Node.ELEMENT_NODE){i={left:s.offsetLeft,top:s.offsetTop,width:s.offsetWidth,height:s.offsetHeight};break}}ae(r,i,o,n)},1)}var ve=null,ge=function(e){var t=e.target||e.srcElement;t.nodeType==Node.TEXT_NODE&&(t=t.parentNode),l(ve,t)||we()},me=function(){if(ve)return ve;o(e,"mousedown",ge,!0),ve=t.createElement("DIV");var n=I.parentNode,r=I.nextSibling;return r?n.insertBefore(ve,r):n.appendChild(ve),le&&le(),ve},we=function(){ve&&(ve.parentNode.removeChild(ve),ve=null,i(e,"mousedown",ge,!0),ce&&ce())},Ce=function(e,t){var n=e.which||e.keyCode,r=String.fromCharCode(n||e.charCode),o=e.shiftKey||!1,i=e.altKey||!1,l=e.ctrlKey||!1,c=e.metaKey||!1;if(1==t?oe&&!1===oe(n,r,o,i,l,c)&&a(e):2==t&&ie&&!1===ie(n,r)&&a(e),2==t&&(pe=null),2!=t&&3!=t||de&&de(null,null,!1),2==t&&ue)switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:break;default:ue()}};o(I,"keydown",function(e){Ce(e,1)}),o(I,"keypress",function(e){Ce(e,2)}),o(I,"keyup",function(e){Ce(e,3)});var be=function(t,n){var r=null,o=null;t.clientX&&t.clientY?(r=t.clientX,o=t.clientY):t.pageX&&t.pageY&&(r=t.pageX-e.pageXOffset,o=t.pageY-e.pageYOffset),t.which&&3==t.which?n=!0:t.button&&2==t.button&&(n=!0),i(e,"mouseup",be),pe=null,!H&&n||de&&de(r,o,n)},ye=null;o(I,"mousedown",function(t){i(e,"mouseup",be),o(e,"mouseup",be),ye=t.target}),o(I,"mouseup",function(n){var r=n.target;if(r&&r.nodeType==Node.ELEMENT_NODE&&r===ye&&c(r)&&l(I,r,!0)){var o=e.getSelection(),i=t.createRange();i.setStartBefore(r),i.setEndAfter(r),o.removeAllRanges(),o.addRange(i)}be(n),ue&&ue()}),o(I,"dblclick",function(e){be(e)}),o(I,"selectionchange",function(e){be(e)}),H&&o(I,"contextmenu",function(e){be(e,!0),a(e)});var Ee=function(e,n,r){if(u(0,pe),I.focus(),!m(I,r))return!1;try{return!(t.queryCommandSupported&&!t.queryCommandSupported(e))&&t.execCommand(e,!1,n)}catch(e){}return!1};if(o(I,"paste",function(e){var t=e.clipboardData;if(t){var n=t.items;if(n&&n.length){var r=n[0];if(r.type.match(/^image\//)){var o=new FileReader;o.onloadend=function(e){var t=e.target.result;t&&Ee("insertImage",t)},o.readAsDataURL(r.getAsFile()),a(e)}}}}),O=function(e){ue&&ue(),e?(d(),pe=null):pe&&(pe=s())},b={sync:function(){return se&&se(),this},getHTML:function(){return I.innerHTML},setHTML:function(e){return I.innerHTML=e||"",O(!0),this},getSelectedHTML:function(){return u(0,pe),m(I)?g():null},collapseSelection:function(){return d(),pe=null,this},expandSelection:function(e,t){return u(0,pe),m(I)?(v(0,e,t),pe=s(),this):this},openPopup:function(){return pe||(pe=s()),me()},activePopup:function(){return ve},closePopup:function(){return we(),this},removeFormat:function(){return Ee("removeFormat"),Ee("unlink"),O(),this},bold:function(){return Ee("bold"),O(),this},italic:function(){return Ee("italic"),O(),this},underline:function(){return Ee("underline"),O(),this},strikethrough:function(){return Ee("strikeThrough"),O(),this},forecolor:function(e){return Ee("foreColor",e),O(),this},highlight:function(e){return Ee("hiliteColor",e)||Ee("backColor",e),O(),this},fontName:function(e){return Ee("fontName",e),O(),this},fontSize:function(e){return Ee("fontSize",e),O(),this},subscript:function(){return Ee("subscript"),O(),this},superscript:function(){return Ee("superscript"),O(),this},insertLink:function(e){return Ee("createLink",e),O(!0),this},insertImage:function(e){return Ee("insertImage",e,!0),O(!0),this},insertHTML:function(e){return Ee("insertHTML",e,!0)||(u(0,pe),m(I,!0),w(I,e)),O(!0),this}},E){var ke=t.createElement("div");if(N(ke,"toolbar"),R)N(ke,"toolbar-top"),S.insertBefore(ke,S.firstChild);else if(z)N(ke,"toolbar-bottom"),S.appendChild(ke);else{var Me=t.createElement("div");N(Me,"toolbar-auto"),S.appendChild(Me),Me.appendChild(ke)}j(ke,null,E,x)}return b};"undefined"!=typeof module&&void 0!==module.exports?module.exports=C:e.wysiwyg=C}(window,document);
