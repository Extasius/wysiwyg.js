/*! wysiwyg.js | https://github.com/wysiwygjs/wysiwyg.js | Apache License (v2) */
/*! Material Design Icons | https://material.io/ | Apache License (v2) */
!function(oe,ie,e){"use strict";var ae=function(n,r,o){var i;return function(){if(i){if(!o)return;clearTimeout(i)}var e=this,t=arguments;i=setTimeout(function(){i=null,n.apply(e,t)},r)}},le=function(e,t,n,r){e.addEventListener(t,n,!!r)},ce=function(e,t,n,r){e.removeEventListener(t,n,!!r)},se=function(e){e.preventDefault(),e.stopPropagation()},ue=function(e,t,n){for(var r=n?t.parentNode:t;r;){if(r===e)return!0;r=r.parentNode}return!1},fe=function(e){var t=e.nodeName;return"IMG"==t||"PICTURE"==t||"SVG"==t||"VIDEO"==t||"AUDIO"==t||"IFRAME"==t||"MAP"==t||"OBJECT"==t||"EMBED"==t},he=function(e){var t=oe.getSelection();return 0<t.rangeCount?t.getRangeAt(0):null},pe=function(e,t){if(t){var n=oe.getSelection();n.removeAllRanges(),n.addRange(t)}},de=function(e){return!!oe.getSelection().isCollapsed},ve=function(){var e=oe.getSelection();if(!e.isCollapsed)try{e.collapseToEnd()}catch(e){}},ge=function(e,t){var n=oe.getSelection();if(ue(e,n.anchorNode)&&ue(e,n.focusNode))return!0;if(!t)return!1;var r=ie.createRange();return r.selectNodeContents(e),r.collapse(!1),n.removeAllRanges(),n.addRange(r),!0},t=function(e,t){var f,n=t.toolbar,r=t.buttons,s=t.selectionbuttons,l=t.suggester,c=t.interceptenter,o=!!t.hijackmenu,k="string"==typeof e?ie.querySelector(e):e,i=k.querySelector("textarea"),u={},h="top"==n,a="bottom"==n,p=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},d=function(e,t){e.classList&&e.classList.remove(t)},v=k.querySelector("[contenteditable=true]");if(!v){(v=ie.createElement("div")).setAttribute("contentEditable","true");var g=i.placeholder;g&&v.setAttribute("placeholder",g),k.insertBefore(v,k.firstChild)}var m=null,w=function(){m&&clearTimeout(m),m=null,p(k,"focus")},C=function(){m||ie.activeElement==v||(m=setTimeout(function(){m=null,d(k,"focus")},50))};le(v,"focus",w),le(v,"blur",C),i&&i.form&&le(i.form,"reset",C);var b,y=function(e,o){var i=ie.createElement("input");i.placeholder="www.example.com",o&&(i.value=o.href),i.style.width="20em",i.style.maxWidth=parseInt(2*k.offsetWidth/3)+"px",i.autofocus=!0,o&&le(i,"input",function(e){var t=i.value.trim();t&&(o.href=t)}),le(i,"keypress",function(e){if(13==(e.which||e.keyCode)){var t=i.value.trim();if(o);else if(t){var n=t;if(/^[a-z0-9]+:\/\//.test(t)||(n="http://"+t),f.getSelectedHTML())f.insertLink(n);else{var r=function(e){return e.replace(/[&<>"]/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[e]||e})};f.insertHTML('<a href="'+r(n)+'">'+r(t)+"</a>")}}f.closePopup().collapseSelection(),v.focus()}}),e.appendChild(i),oe.setTimeout(function(){i.focus(),w()},1)},E=function(e,n){var t=function(e,t,n){var r,o,i,a,l,c,s,u;switch(c=n*(1-t),s=n*(1-(l=6*e-(a=Math.floor(6*e)))*t),u=n*(1-(1-l)*t),a%6){case 0:r=n,o=u,i=c;break;case 1:r=s,o=n,i=c;break;case 2:r=c,o=n,i=u;break;case 3:r=c,o=s,i=n;break;case 4:r=u,o=c,i=n;break;case 5:r=n,o=c,i=s}var f=Math.floor(255*r).toString(16),h=Math.floor(255*o).toString(16),p=Math.floor(255*i).toString(16);return"#"+(f.length<2?"0":"")+f+(h.length<2?"0":"")+h+(p.length<2?"0":"")+p},r=ie.createElement("table");r.style.borderCollapse="collapse";for(var o=1;o<15;++o){for(var i=ie.createElement("tr"),a=0;a<25;++a){var l;if(24==a){var c=Math.floor(255/13*(14-o)).toString(16),s=(c.length<2?"0":"")+c;l="#"+s+s+s}else{l=t(a/24,o<=8?o/8:1,8<o?(16-o)/8:1)}var u=ie.createElement("td");u.style.width="0.5em",u.style.height="0.5em",u.style.cursor="pointer",u.style.backgroundColor=l,u.title=l,u.style.userSelect="none",le(u,"click",function(e){var t=this.title;n?f.forecolor(t).closePopup().collapseSelection():f.highlight(t).closePopup().collapseSelection()}),i.appendChild(u)}r.appendChild(i)}e.appendChild(r)},M=function(e,t,n){for(var r=k.offsetParent,o=0,i=0,a=!1,l=0,c=0,s=!1,u=!1;r;){l+=r.offsetLeft,c+=r.offsetTop;var f=getComputedStyle(r);"static"!=f.position?a=!0:a||(o+=r.offsetLeft,i+=r.offsetTop),"fixed"==f.position&&(s=!0),"visible"!=f.overflow&&(u=!0),r=r.offsetParent}var h=k.offsetParent||ie.body;h.appendChild(e),t+=o+k.offsetLeft,n+=i+k.offsetTop;var p=e.offsetWidth;if(s||u){var d=h.offsetWidth;d-1<t+p&&(t=d-p-1),t<1&&(t=1)}var v=e.offsetHeight;if(s||u){var g=h.offsetHeight;g-1<n+v&&(n=g-v-1),n<1&&(n=1)}var m=oe.innerWidth,w=s?0:ie.documentElement.scrollLeft;m+w-2<l+t+p&&(t=m+w-l-p-2),l+t<w+1&&(t=w-l+1);var C=oe.innerHeight,b=s?0:ie.documentElement.scrollTop;C+b-2<c+n+v&&(n=C+b-c-v-2),c+n<b+1&&(n=b-c+1),e.style.left=parseInt(t)+"px",e.style.top=parseInt(n)+"px"},S=null,L=function(e,t,n,r){var o=f.activePopup();for(o&&S===t?(d(o,"animate-down"),d(o,"animate-up")):(o=f.openPopup(),p(o,"wysiwyg-popup"),p(o,e?"animate-down":"animate-up"),S=t);o.firstChild;)o.removeChild(o.firstChild);return n(o,r),o},H=function(e,t,n,r){var o=L(!!h,t,n,r),i=k.getBoundingClientRect(),a=e.getBoundingClientRect(),l=a.left-i.left+parseInt(e.offsetWidth/2)-parseInt(o.offsetWidth/2),c=a.top-i.top;h?c+=e.offsetHeight:c-=o.offsetHeight,M(o,l,c)},T=function(e,t){var n=k.getBoundingClientRect(),r=v.getBoundingClientRect(),o=t.left+parseInt(t.width/2)-parseInt(e.offsetWidth/2)+r.left-n.left,i=t.top+t.height+r.top-n.top;M(e,o,i)},x=function(e,t,n,r){var o=L(!0,t,n,r);T(o,e)},R=null,z=null,N=function(o,i,e,a){e.forEach(function(c){if(c instanceof Element||c instanceof HTMLDocument)return o.appendChild(c),le(c,"focus",w),void le(c,"blur",C);var s=ie.createElement("button");if(p(s,"btn"),"icon"in c){var e=null;switch(c.icon){case"link":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg>';break;case"bold":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"/></svg>';break;case"italic":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z"/></svg>';break;case"underline":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"/></svg>';break;case"strikethrough":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M7.24 8.75c-.26-.48-.39-1.03-.39-1.67 0-.61.13-1.16.4-1.67.26-.5.63-.93 1.11-1.29.48-.35 1.05-.63 1.7-.83.66-.19 1.39-.29 2.18-.29.81 0 1.54.11 2.21.34.66.22 1.23.54 1.69.94.47.4.83.88 1.08 1.43s.38 1.15.38 1.81h-3.01c0-.31-.05-.59-.15-.85-.09-.27-.24-.49-.44-.68-.2-.19-.45-.33-.75-.44-.3-.1-.66-.16-1.06-.16-.39 0-.74.04-1.03.13s-.53.21-.72.36c-.19.16-.34.34-.44.55-.1.21-.15.43-.15.66 0 .48.25.88.74 1.21.38.25.77.48 1.41.7H7.39c-.05-.08-.11-.17-.15-.25zM21 12v-2H3v2h9.62c.18.07.4.14.55.2.37.17.66.34.87.51s.35.36.43.57c.07.2.11.43.11.69 0 .23-.05.45-.14.66-.09.2-.23.38-.42.53-.19.15-.42.26-.71.35-.29.08-.63.13-1.01.13-.43 0-.83-.04-1.18-.13s-.66-.23-.91-.42c-.25-.19-.45-.44-.59-.75s-.25-.76-.25-1.21H6.4c0 .55.08 1.13.24 1.58s.37.85.65 1.21c.28.35.6.66.98.92.37.26.78.48 1.22.65.44.17.9.3 1.38.39.48.08.96.13 1.44.13.8 0 1.53-.09 2.18-.28s1.21-.45 1.67-.79c.46-.34.82-.77 1.07-1.27s.38-1.07.38-1.71c0-.6-.1-1.14-.31-1.61-.05-.11-.11-.23-.17-.33H21V12z"/></svg>';break;case"colortext":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path fill-opacity=".36" d="M0 20h24v4H0v-4z"/><path d="M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z"/></svg>';break;case"colorfill":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z"/><path fill-opacity=".36" d="M0 20h24v4H0v-4z"/></svg>';break;case"clearformat":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 8V5H6.39l3 3h1.83l-.55 1.28 2.09 2.1L14.21 8zM3.41 4.86L2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21l1.41-1.41z"/></svg>';break;case"photo":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86l-3 3.87L9 13.14 6 17h12l-3.86-5.14z"/></svg>';break;case"attachment":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/></svg>';break;case"emoticon":e='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg>'}if(e){var t=ie.implementation.createHTMLDocument("");t.body.innerHTML=e,s.appendChild(t.body.firstChild)}}if(c.attr)for(var n in c.attr)s.setAttribute(n,c.attr[n]);le(s,"focus",w),le(s,"blur",C);var r=null;"click"in c?r=function(){c.click(f,s)}:"popup"in c?r=function(){var e=function(e){c.popup(f,e,s)};i?x(i,e.toString(),e):H(s,e.toString(),e)}:"browse"in c||"dataurl"in c?r=function(){f.closePopup().collapseSelection();var a=ie.createElement("input");a.type="file",a.multiple=!0,a.style.display="none",le(a,"change",function(e){var t="dataurl"in c;if(e.target.files)for(var n=l.target.files,r=0;r<n.length;++r){var o=n[r];if("browse"in c)c.browse(f,a,o,s);else if(o.size<16777216){var i=new FileReader;i.onloadend=function(e){c.dataurl(f,o.type,e.target.result,s)},i.readAsDataURL(o)}}else t=!0;t&&a.parentNode.removeChild(a),se(e)}),k.appendChild(a);var l=ie.createEvent("MouseEvents");l.initEvent("click",!0,!1),a.dispatchEvent(l)}:"action"in c&&(r=function(){switch(c.action){case"link":i?x(i,"link",y,z):H(s,"link",y,z);break;case"bold":f.bold().closePopup().collapseSelection();break;case"italic":f.italic().closePopup().collapseSelection();break;case"underline":f.underline().closePopup().collapseSelection();break;case"strikethrough":f.strikethrough().closePopup().collapseSelection();break;case"colortext":i?x(i,"colortext",E,!0):H(s,"colortext",E,!0);break;case"colorfill":i?x(i,"colorfill",E,!1):H(s,"colorfill",E,!1);break;case"clearformat":f.removeFormat().closePopup().collapseSelection()}}),s.onclick=function(e){r&&r(),se(e)},o.appendChild(s),"hotkey"in c&&r&&a&&(a[c.hotkey.toLowerCase()]=r)})},A=null,I=1,B=null,P=function(e){e&&f.expandSelection(A.length,0).insertHTML(e),B=A=null,I+=1,f.closePopup()},D=ae(function(){if(A){var t=I;l(A,function(e){R&&t==I&&(B=null,e?x(R,"suggestion",function(n){e.forEach(function(t){var e=ie.createElement("div");p(e,"suggestion"),e.innerHTML=t.label,e.style.cursor="pointer",le(e,"click",function(e){P(t.insert),se(e)}),n.appendChild(e),null===B&&(B=t.insert)})}):P())})||P()}},100,!0),V=function(e,t,n,r,o,i){if(c&&13==e&&!n&&!r&&!o&&!i&&c())return f.sync().closePopup(),!1;if(t&&!n&&!r&&o&&!i){var a=t.toLowerCase();if(u[a])return u[a](),!1}return l?13!=e||!B||(P(B),!1):void 0},O=function(e,t,n,r,o,i){if(l)return function(e,t,n,r,o,i){switch(e){case 8:if(A&&(A=A.slice(0,-1)),A)break;return P(),!0;case 13:case 27:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:return A&&P(),!0;default:A||(A=""),A+=t}return D(),!0}(e,t)},W=function(e,n,t,r){if(R=e?n||R:null,z=null,n)if(e&&null!==A){var o=f.activePopup();o&&(d(o,"animate-down"),d(o,"animate-up"),T(o,n))}else{for(var i=0;i<t.length;++i){var a=t[i],l=a.closest||function(e){for(var t=this;t;){var n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;if(n&&n.call(t,e))return t;t=t.parentElement}return null};if(z=l.call(a,"a"))break}var c=!0;r||(s?e?c=!1:t.forEach(function(e){fe(e)&&(c=!1)}):c=!1),c?x(n,"selection",function(e){var t=ie.createElement("div");p(t,"toolbar"),e.appendChild(t),N(t,n,s)}):P()}else P()},F=function(){w()},_=function(){P(),C()},q=null,X=null;if(i){!v.innerHTML&&i.value&&(v.innerHTML=i.value);var Y=v.innerHTML;q=function(){var e=v.innerHTML;e.match(/^<br[/ ]*>$/i)&&(e=v.innerHTML=""),e!=Y&&(i.value=e,Y=e)},le(v,"focus",function(){var e=ie.createEvent("Event");e.initEvent("focus",!1,!1),i.dispatchEvent(e)}),le(v,"blur",function(){q();var e=ie.createEvent("Event");e.initEvent("blur",!1,!1),i.dispatchEvent(e)}),X=ae(q,250,!0),le(v,"input",X),le(v,"propertychange",X),le(v,"textInput",X),le(v,"paste",X),le(v,"cut",X),le(v,"drop",X),new MutationObserver(X).observe(v,{attributes:!0,childList:!0,characterData:!0,subtree:!0});var K=i.form;K&&le(K,"reset",function(){v.innerHTML="",X(),b(!0)})}var U=null,G=null;G=ae(function(e,t,n){var r=de(),o=function(e){var t=oe.getSelection();if(!t.rangeCount)return[];for(var n=[],r=0;r<t.rangeCount;++r)for(var o=(c=t.getRangeAt(r)).startContainer,i=c.endContainer;o;){if(o!=e){var a=!1;if(t.containsNode)a=t.containsNode(o,!0);else{var l=ie.createRange();for(l.selectNodeContents(o),r=0;r<t.rangeCount;++r){var c;if(0<=(c=t.getRangeAt(r)).compareBoundaryPoints(c.END_TO_START,l)&&c.compareBoundaryPoints(c.START_TO_END,l)<=0){a=!0;break}}}a&&n.push(o)}o=function(e,t){if(e.firstChild)return e.firstChild;for(;e;){if(e==t)return null;if(e.nextSibling)return e.nextSibling;e=e.parentNode}return null}(o,o==i?i:e)}return 0==n.length&&ue(e,t.focusNode)&&t.focusNode!=e&&n.push(t.focusNode),n}(v),i=null===e||null===t?null:{left:e,top:t,width:0,height:0},a=function(){var e=oe.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).cloneRange();if((o=t.getBoundingClientRect())&&o.left&&o.top&&o.right&&o.bottom)return{left:parseInt(o.left),top:parseInt(o.top),width:parseInt(o.right-o.left),height:parseInt(o.bottom-o.top)};for(var n=t.getClientRects?t.getClientRects():[],r=0;r<n.length;++r){var o;if((o=n[r]).left&&o.top&&o.right&&o.bottom)return{left:parseInt(o.left),top:parseInt(o.top),width:parseInt(o.right-o.left),height:parseInt(o.bottom-o.top)}}return!1}();if(a&&(i=a),i){var l=v.getBoundingClientRect();i.left-=parseInt(l.left),i.top-=parseInt(l.top),i.left<0&&(i.left=0),i.top<0&&(i.top=0),i.width>v.offsetWidth&&(i.width=v.offsetWidth),i.height>v.offsetHeight&&(i.height=v.offsetHeight)}else if(o.length)for(var c=0;c<o.length;++c){var s=o[c];if(s.nodeType==Node.ELEMENT_NODE){i={left:s.offsetLeft,top:s.offsetTop,width:s.offsetWidth,height:s.offsetHeight};break}}W(r,i,o,n)},1);var j=null,J=function(e){var t=e.target||e.srcElement;t.nodeType==Node.TEXT_NODE&&(t=t.parentNode),ue(j,t)||$()},$=function(){j&&(j.parentNode.removeChild(j),ce(oe,"mousedown",J,!(j=null)),_())},Q=function(e,t){var n=e.which||e.keyCode,r=String.fromCharCode(n||e.charCode),o=e.shiftKey||!1,i=e.altKey||!1,a=e.ctrlKey||!1,l=e.metaKey||!1;if(1==t?!1===V(n,r,o,i,a,l)&&se(e):2==t&&!1===O(n,r)&&se(e),U&&(U=he()),2!=t&&3!=t||G&&G(null,null,!1),2==t&&X)switch(n){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:break;default:X()}};le(v,"keydown",function(e){Q(e,1)}),le(v,"keypress",function(e){Q(e,2)}),le(v,"keyup",function(e){Q(e,3)});var Z=function(e,t){var n=null,r=null;e.clientX&&e.clientY?(n=e.clientX,r=e.clientY):e.pageX&&e.pageY&&(n=e.pageX-oe.pageXOffset,r=e.pageY-oe.pageYOffset),e.which&&3==e.which?t=!0:e.button&&2==e.button&&(t=!0),ce(oe,"mouseup",Z),U&&(U=he()),!o&&t||G&&G(n,r,t)},ee=null;le(v,"mousedown",function(e){ce(oe,"mouseup",Z),le(oe,"mouseup",Z),ee=e.target}),le(v,"mouseup",function(e){var t=e.target;if(t&&t.nodeType==Node.ELEMENT_NODE&&t===ee&&fe(t)&&ue(v,t,!0)){var n=oe.getSelection(),r=ie.createRange();r.setStartBefore(t),r.setEndAfter(t),n.removeAllRanges(),n.addRange(r)}Z(e),X&&X()}),le(v,"dblclick",function(e){Z(e)}),le(v,"selectionchange",function(e){Z(e)}),o&&le(v,"contextmenu",function(e){Z(e,!0),se(e)});var te=function(e,t,n){if(pe(0,U),v.focus(),!ge(v,n))return!1;try{return!(ie.queryCommandSupported&&!ie.queryCommandSupported(e))&&ie.execCommand(e,!1,t)}catch(e){}return!1};if(le(v,"paste",function(e){var t=e.clipboardData;if(t){var n=t.items;if(n&&n.length){var r=n[0];if(r.type.match(/^image\//)){var o=new FileReader;o.onloadend=function(e){var t=e.target.result;t&&te("insertImage",t)},o.readAsDataURL(r.getAsFile()),se(e)}}}}),b=function(e){X&&X(),e?(ve(),U=null):U&&(U=he())},f={sync:function(){return q&&q(),this},getHTML:function(){return v.innerHTML},setHTML:function(e){return v.innerHTML=e||"",b(!0),this},getSelectedHTML:function(){return pe(0,U),ge(v)?function(e){if(de())return null;var t=oe.getSelection();if(t.rangeCount){for(var n=ie.createElement("div"),r=t.rangeCount,o=0;o<r;++o){var i=t.getRangeAt(o).cloneContents();n.appendChild(i)}return n.innerHTML}return null}():null},collapseSelection:function(){return ve(),U=null,this},expandSelection:function(e,t){return pe(0,U),ge(v)&&(function(e,t,n){var r=oe.getSelection();if(r.modify){for(var o=0;o<t;++o)r.modify("extend","backward","character");for(o=0;o<n;++o)r.modify("extend","forward","character")}else{var i=r.getRangeAt(0);i.setStart(i.startContainer,i.startOffset-t),i.setEnd(i.endContainer,i.endOffset+n),r.removeAllRanges(),r.addRange(i)}}(0,e,t),U=he()),this},openPopup:function(){return U||(U=he()),function(){if(j)return j;le(oe,"mousedown",J,!0),j=ie.createElement("DIV");var e=v.parentNode,t=v.nextSibling;return t?e.insertBefore(j,t):e.appendChild(j),F(),j}()},activePopup:function(){return j},closePopup:function(){return $(),this},removeFormat:function(){return te("removeFormat"),te("unlink"),b(),this},bold:function(){return te("bold"),b(),this},italic:function(){return te("italic"),b(),this},underline:function(){return te("underline"),b(),this},strikethrough:function(){return te("strikeThrough"),b(),this},forecolor:function(e){return te("foreColor",e),b(),this},highlight:function(e){return te("hiliteColor",e)||te("backColor",e),b(),this},fontName:function(e){return te("fontName",e),b(),this},fontSize:function(e){return te("fontSize",e),b(),this},subscript:function(){return te("subscript"),b(),this},superscript:function(){return te("superscript"),b(),this},insertLink:function(e){return te("createLink",e),b(!0),this},insertImage:function(e){return te("insertImage",e,!0),b(!0),this},insertHTML:function(e){return te("insertHTML",e,!0)||(pe(0,U),ge(v,!0),function(e,t){var n=oe.getSelection();if(n.getRangeAt&&n.rangeCount){var r=n.getRangeAt(0),o=ie.createElement("div");o.innerHTML=t;for(var i,a,l=ie.createDocumentFragment();i=o.firstChild;)a=l.appendChild(i);ue(e,r.commonAncestorContainer)?(r.deleteContents(),r.insertNode(l)):e.appendChild(l),a&&((r=r.cloneRange()).setStartAfter(a),r.collapse(!0),n.removeAllRanges(),n.addRange(r))}}(v,e)),b(!0),this}},r){var ne=ie.createElement("div");if(p(ne,"toolbar"),h)p(ne,"toolbar-top"),k.insertBefore(ne,k.firstChild);else if(a)p(ne,"toolbar-bottom"),k.appendChild(ne);else{var re=ie.createElement("div");p(re,"toolbar-auto"),k.appendChild(re),re.appendChild(ne)}N(ne,null,r,u)}return f};"undefined"!=typeof module&&void 0!==module.exports?module.exports=t:oe.wysiwyg=t}(window,document);
